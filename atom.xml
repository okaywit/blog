<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  
  <title><![CDATA[大辉Face]]></title>
  <subtitle><![CDATA[我愿做一个孤独的行者，守护心中的那份宁静！]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://www.okaywit.com//"/>
  <updated>2015-07-03T07:49:05.255Z</updated>
  <id>http://www.okaywit.com//</id>
  
  <author>
    <name><![CDATA[Wang Hui]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[tomcat配置原理介绍]]></title>
    <link href="http://www.okaywit.com/2015/07/02/tomcat-details/"/>
    <id>http://www.okaywit.com/2015/07/02/tomcat-details/</id>
    <published>2015-07-03T01:48:12.000Z</published>
    <updated>2015-07-03T07:49:05.255Z</updated>
    <content type="html"><![CDATA[<p>主要介绍一些tomcat日常配置相关的内容原理<br><img src="http://7xk4gy.com1.z0.glb.clouddn.com/okaywit_server.jpg"></p>
<a id="more"></a>
<h3 id="目录介绍">目录介绍</h3><ul>
<li>bin 脚本</li>
<li>conf 配置文件 </li>
<li>logs 日志</li>
<li>webapps 应用</li>
</ul>
<h3 id="catalina-home">catalina.home</h3><pre><code>对应系统变量配置中的CATALIN<span class="built_in">A_HOME</span>，指定bin、lib目录位置。
</code></pre><h3 id="catalina-base">catalina.base</h3><pre><code>对应系统变量配置中的CATALIN<span class="built_in">A_BASE</span>，指定conf、logs、temp、webapps、work目录位置。
</code></pre><h3 id="server-xml说明">server.xml说明</h3><ol>
<li><p>tomcat的核心配置文件，对外提供web服务。</p>
</li>
<li><p>Service表示提供具体服务内容，Connector配置提供服务的监听端口；<br> Engine表示提供服务的引擎，Host表示访问的资源位置，Context表示设定访问的url。</p>
</li>
</ol>
<p>Server结构图如下：<br><img src="http://7xk4gy.com1.z0.glb.clouddn.com/okaywit_server.jpg"></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>主要介绍一些tomcat日常配置相关的内容原理<br><img src="http://7xk4gy.com1.z0.glb.clouddn.com/okaywit_server.jpg"></p>]]>
    
    </summary>
    
      <category term="tomcat" scheme="http://www.okaywit.com/tags/tomcat/"/>
    
      <category term="tomcat" scheme="http://www.okaywit.com/categories/tomcat/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[markdown语法详解]]></title>
    <link href="http://www.okaywit.com/2015/07/01/markdown/"/>
    <id>http://www.okaywit.com/2015/07/01/markdown/</id>
    <published>2015-07-01T21:47:30.000Z</published>
    <updated>2015-07-02T03:42:51.637Z</updated>
    <content type="html"><![CDATA[<p>markdown常用语法解释说明，标题、链接、强调.<br><a id="more"></a></p>
<h3 id="标题"><em>标题</em></h3><h1 id="一级标题_#内容">一级标题 <code>#内容</code></h1><h2 id="二级标题_##内容">二级标题 <code>##内容</code></h2><h3 id="三级标题_###内容">三级标题 <code>###内容</code></h3><h4 id="四级标题_####内容">四级标题 <code>####内容</code></h4><h5 id="五级标题_#####内容">五级标题 <code>#####内容</code></h5><h6 id="六级标题_######内容">六级标题 <code>######内容</code></h6><h3 id="链接"><em>链接</em></h3><p>eg:    <a href="http://www.okaywit.com/" title="okaywit">首页</a></p>
<p>code: <code>[首页](http://www.okaywit.com/ &quot;okaywit&quot;)</code></p>
<p>eg: <a href="http://www.okaywit.com/">http://www.okaywit.com/</a></p>
<p>code: <code>&lt;http://www.okaywit.com/&gt;</code></p>
<h3 id="强调"><em>强调</em></h3><p>eg: <em>斜体</em></p>
<p>code: <code>*内容*</code> 或 <code>_内容_</code></p>
<p>eg: <strong>加粗</strong></p>
<p>code: <code>**内容**</code> 或 <code>__内容__</code></p>
<h3 id="代码"><em>代码</em></h3><p>eg: <code>代码</code></p>
<p>code: <code>`代码` </code> </p>
<h3 id="引用"><em>引用</em></h3><p>eg:</p>
<blockquote>
<p>应用区域</p>
</blockquote>
<p>code: <code>&gt;内容</code></p>
<h3 id="无序列表"><em>无序列表</em></h3><p>eg:</p>
<ul>
<li>a</li>
</ul>
<ul>
<li>b</li>
</ul>
<ul>
<li>c</li>
</ul>
<p>code: <code>* 内容</code> 或 <code>+ 内容</code> 或 <code>-内容</code></p>
<h3 id="有序列表"><em>有序列表</em></h3><p>eg: </p>
<ol>
<li>a</li>
<li>b</li>
</ol>
<p>code: <code>数字. 内容</code></p>
<h3 id="下划线"><em>下划线</em></h3><p>eg: </p>
<hr>
<p>code: <code>***</code> 或 <code>---</code> 或 <code>____</code></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>markdown常用语法解释说明，标题、链接、强调.<br>]]>
    
    </summary>
    
      <category term="markdown" scheme="http://www.okaywit.com/tags/markdown/"/>
    
      <category term="日常笔记" scheme="http://www.okaywit.com/categories/%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[websocket简单实例-聊天]]></title>
    <link href="http://www.okaywit.com/2015/06/30/websocket-demo-chat/"/>
    <id>http://www.okaywit.com/2015/06/30/websocket-demo-chat/</id>
    <published>2015-07-01T04:10:37.000Z</published>
    <updated>2015-07-02T12:06:01.494Z</updated>
    <content type="html"><![CDATA[<p>通过websocket建立的一个简单聊天工具，web服务器使用tomcat 8.0。</p>
<a id="more"></a>
<h2 id="客户端">客户端</h2><h3 id="ws-js代码">ws.js代码</h3><pre><code><span class="keyword">var</span> Server = {};
Server.socket = <span class="literal">null</span>;
Server.connect=(<span class="function"><span class="keyword">function</span>(<span class="params">host</span>)</span>{
    Server.socket = <span class="keyword">new</span> WebSocket(host);
    Server.socket.onopen = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{

    };
    Server.socket.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">message</span>)</span>{
        <span class="built_in">console</span>.log(message.data);
    };
    Server.socket.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>{

    };
    Server.socket.onclose = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{

    };
});
Server.init=<span class="function"><span class="keyword">function</span>(<span class="params">path</span>)</span>{
    Server.connect(<span class="string">"ws://localhost:8080/okaywit/"</span>+path);
};
</code></pre><h3 id="chat-html代码">chat.html代码</h3><pre><code><span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;<span class="title">html</span>&gt;</span>
<span class="tag">&lt;<span class="title">head</span> <span class="attribute">lang</span>=<span class="value">"en"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">name</span>=<span class="value">"viewport"</span> <span class="attribute">content</span>=<span class="value">"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">title</span>&gt;</span>大辉Face<span class="tag">&lt;/<span class="title">title</span>&gt;</span>
    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">name</span>=<span class="value">"keywords"</span> <span class="attribute">content</span>=<span class="value">"Polymer,WebSocket,Java,Tomcat,Html5"</span> /&gt;</span>
    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">name</span>=<span class="value">"description"</span> <span class="attribute">content</span>=<span class="value">"免费的 web 技术教程。"</span> /&gt;</span>
<span class="tag">&lt;/<span class="title">head</span>&gt;</span>
<span class="comment">&lt;!-- 新 Bootstrap 核心 CSS 文件 --&gt;</span>
<span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"http://cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css"</span>&gt;</span>

<span class="comment">&lt;!-- jQuery文件。务必在bootstrap.min.js 之前引入 --&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"http://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>

<span class="comment">&lt;!-- 最新的 Bootstrap 核心 JavaScript 文件 --&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"http://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;<span class="title">style</span> <span class="attribute">type</span>=<span class="value">"text/css"</span>&gt;</span><span class="css">
    <span class="class">.IM</span><span class="rules">{
        <span class="rule"><span class="attribute">text-align</span>:<span class="value"> left</span></span>;
        <span class="rule"><span class="attribute">overflow</span>:<span class="value">hidden</span></span>;
        <span class="rule"><span class="attribute">word-wrap</span>:<span class="value"> break-word</span></span>;
    }</span>
    <span class="class">.OM</span><span class="rules">{
        <span class="rule"><span class="attribute">text-align</span>:<span class="value"> right</span></span>;
        <span class="rule"><span class="attribute">overflow</span>:<span class="value">hidden</span></span>;
        <span class="rule"><span class="attribute">word-wrap</span>:<span class="value"> break-word</span></span>;
    }</span>
</span><span class="tag">&lt;/<span class="title">style</span>&gt;</span>
<span class="tag">&lt;<span class="title">body</span> <span class="attribute">class</span>=<span class="value">"container-fluid"</span>&gt;</span>

    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row"</span>&gt;</span>
        <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"col-xs-12 col-md-7 col-md-offset-1"</span> <span class="attribute">style</span>=<span class="value">""</span> <span class="attribute">id</span>=<span class="value">"M"</span>&gt;</span>

        <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
        <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"col-xs-12 col-md-3"</span>  <span class="attribute">style</span>=<span class="value">"background: gray"</span>&gt;</span>

        <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">nav</span> <span class="attribute">class</span>=<span class="value">"navbar navbar-default navbar-fixed-bottom"</span>&gt;</span>
        <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"container"</span>&gt;</span>
            <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row"</span>&gt;</span>
                <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"col-xs-12 col-md-12"</span> <span class="attribute">style</span>=<span class="value">"padding:10px 0px 10px 0px"</span>&gt;</span>
                    <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">class</span>=<span class="value">"form-control input-lg"</span> <span class="attribute">id</span>=<span class="value">"message"</span> <span class="attribute">placeholder</span>=<span class="value">"Enter键发送...."</span>&gt;</span>
                <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
            <span class="tag">&lt;/<span class="title">div</span>&gt;</span>

        <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">nav</span>&gt;</span>

<span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"js/ws.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript">
    <span class="keyword">var</span> id;
    Server.init(<span class="string">"chat"</span>);
    Server.socket.onmessage=<span class="function"><span class="keyword">function</span>(<span class="params">message</span>)</span>{
        <span class="keyword">var</span> data = <span class="built_in">eval</span>(<span class="string">'('</span>+message.data+<span class="string">')'</span>);
        <span class="keyword">if</span>(id==<span class="literal">undefined</span>){
            <span class="keyword">if</span>(data[<span class="string">"message"</span>]==<span class="string">""</span>){
                id=data[<span class="string">"id"</span>];
            }
            <span class="keyword">return</span>;
        }
        <span class="keyword">var</span> msg = <span class="string">"&lt;div class='row'&gt;&lt;div class='col-xs-6 col-md-6 col-xs-offset-6 col-md-offset-6 OM well'&gt;"</span>+data[<span class="string">"message"</span>]+<span class="string">"&lt;/div&gt;&lt;/div&gt;"</span>;
        <span class="built_in">document</span>.getElementById(<span class="string">"M"</span>).innerHTML = msg+<span class="built_in">document</span>.getElementById(<span class="string">"M"</span>).innerHTML;
    };

    <span class="built_in">document</span>.getElementById(<span class="string">"message"</span>).addEventListener(<span class="string">"keydown"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>{
        <span class="keyword">if</span>(e.keyCode==<span class="number">13</span>){
            <span class="keyword">var</span> msg = <span class="string">"&lt;div class='row'&gt;&lt;div class='col-xs-6 col-md-6 IM well'&gt;"</span>+<span class="keyword">this</span>.value+<span class="string">"&lt;/div&gt;&lt;/div&gt;"</span>;
            <span class="built_in">document</span>.getElementById(<span class="string">"M"</span>).innerHTML = msg + <span class="built_in">document</span>.getElementById(<span class="string">"M"</span>).innerHTML;
            Server.socket.send(packData(<span class="number">1</span>,id,<span class="keyword">this</span>.value));
            <span class="keyword">this</span>.blur();
            <span class="keyword">this</span>.value=<span class="string">""</span>;
        }
    });

    <span class="function"><span class="keyword">function</span> <span class="title">packData</span>(<span class="params">hId,id,msg</span>)</span>{
        <span class="keyword">return</span> <span class="string">'{"hId":'</span>+hId+<span class="string">',"id":'</span>+id+<span class="string">',"message":"'</span>+msg+<span class="string">'"}'</span>;
    }

</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</code></pre><h2 id="服务端">服务端</h2><h3 id="ChatServer-java">ChatServer.java</h3><pre><code><span class="built_in">import</span> java.io.IOException;
<span class="built_in">import</span> java.util.HashMap;
<span class="built_in">import</span> java.util.Iterator;
<span class="built_in">import</span> java.util.Map;
<span class="built_in">import</span> java.util.Map.Entry;
<span class="built_in">import</span> java.util.concurrent.atomic.AtomicLong;
<span class="built_in">import</span> javax.websocket.OnClose;
<span class="built_in">import</span> javax.websocket.OnError;
<span class="built_in">import</span> javax.websocket.OnMessage;
<span class="built_in">import</span> javax.websocket.OnOpen;
<span class="built_in">import</span> javax.websocket.Session;
<span class="built_in">import</span> javax.websocket.server.ServerEndpoint;
<span class="built_in">import</span> com.alibaba.fastjson.JSONObject;

<span class="comment">/**
 * 聊天工具服务器
 * 
 * @author Wang Hui
 */</span>
@ServerEndpoint<span class="params">(<span class="string">"/chat"</span>)</span>
public class ChatServer {
        <span class="comment">//自增ID</span>
        private static AtomicLong ids = new AtomicLong<span class="params">()</span>;
        <span class="comment">//会话缓存</span>
        private static Map&lt;Long, Session&gt; sessionMap = new HashMap&lt;Long, Session&gt;<span class="params">()</span>;

        @OnOpen
        public void open<span class="params">(Session session)</span> {
                long id = ids.getAndIncrement<span class="params">()</span>;
                <span class="comment">//缓存</span>
                sessionMap.put<span class="params">(id, session)</span>;
                try {
                        <span class="comment">//推送id给用户</span>
                        session.getBasicRemote<span class="params">()</span>.sendText<span class="params">(String.format<span class="params">(<span class="string">"{\"id\":\"%d\",\"message\":\"%s\"}"</span>, id, <span class="string">""</span>)</span>)</span>;
                } catch <span class="params">(IOException e)</span> {
                        e.printStackTrace<span class="params">()</span>;
                }

        }

        @OnMessage
        public void message<span class="params">(String message)</span> {
                JSONObject data = JSONObject.parseObject<span class="params">(message)</span>;
                <span class="comment">//推送消息</span>
                <span class="keyword">for</span> <span class="params">(Iterator&lt;Entry&lt;Long, Session&gt;&gt; it = sessionMap.entrySet<span class="params">()</span>.iterator<span class="params">()</span>; it.hasNext<span class="params">()</span>;)</span> {
                        Entry&lt;Long, Session&gt; entry = it.next<span class="params">()</span>;
                        try {
                                <span class="keyword">if</span> <span class="params">(entry.getKey<span class="params">()</span> == data.getLongValue<span class="params">(<span class="string">"id"</span>)</span>)</span>
                                        continue;

                                Session session = entry.getValue<span class="params">()</span>;
                                <span class="keyword">if</span> <span class="params">(session.isOpen<span class="params">()</span>)</span>
                                        session.getBasicRemote<span class="params">()</span>.sendText<span class="params">(message)</span>;
                                <span class="keyword">else</span>
                                        it.remove<span class="params">()</span>;
                        } catch <span class="params">(IOException e)</span> {
                                e.printStackTrace<span class="params">()</span>;
                        }
                }
        }

        @OnClose
        public void close<span class="params">(Session session)</span> {
                <span class="keyword">for</span> <span class="params">(Iterator&lt;Entry&lt;Long, Session&gt;&gt; it = sessionMap.entrySet<span class="params">()</span>.iterator<span class="params">()</span>; it.hasNext<span class="params">()</span>;)</span> {
                        Entry&lt;Long, Session&gt; entry = it.next<span class="params">()</span>;
                        <span class="keyword">if</span> <span class="params">(entry.getValue<span class="params">()</span> == session)</span> {
                                <span class="comment">//会话关闭删除</span>
                                sessionMap.remove<span class="params">(entry.getKey<span class="params">()</span>)</span>;
                                break;
                        }
                }

        }

        @OnError
        public void error<span class="params">(Throwable t)</span> throws Throwable {
                t.printStackTrace<span class="params">()</span>;
        }
}
</code></pre><h2 id="jar包下载">jar包下载</h2><p><a href="http://pan.baidu.com/s/1bn4kAOB" title="json解析、websocket" target="_blank" rel="external">json解析、websocket</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>通过websocket建立的一个简单聊天工具，web服务器使用tomcat 8.0。</p>]]>
    
    </summary>
    
      <category term="websocket" scheme="http://www.okaywit.com/tags/websocket/"/>
    
      <category term="websocket" scheme="http://www.okaywit.com/categories/websocket/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[linux常用命令]]></title>
    <link href="http://www.okaywit.com/2015/06/30/linux-common-commands/"/>
    <id>http://www.okaywit.com/2015/06/30/linux-common-commands/</id>
    <published>2015-07-01T04:10:37.000Z</published>
    <updated>2015-07-02T10:22:02.630Z</updated>
    <content type="html"><![CDATA[<p>日常使用的高频率linux命令汇总，例如：rm、tar、find、ps、unzip等。<br><a id="more"></a></p>
<h3 id="rm">rm</h3><pre><code>删除目录：rm -r 目录 (-<span class="string">r:</span>递归删除该目录下文件，-<span class="string">f:</span>强制删除)
</code></pre><h3 id="tar">tar</h3><pre><code><span class="tag">tar</span><span class="class">.gz</span>文件：<span class="tag">tar</span> <span class="tag">-xzf</span> 文件名
</code></pre><h3 id="find">find</h3><pre><code>查找目录： <span class="keyword">find</span> /范围 -name <span class="string">'关键字'</span> -<span class="built_in">type</span> <span class="keyword">d</span>
查找文件： <span class="keyword">find</span> /范围 -name <span class="string">'关键字'</span> -<span class="keyword">print</span>
</code></pre><h3 id="unzip">unzip</h3><pre><code>解压到指定目录： unzip <span class="keyword">zip</span>文件 -<span class="keyword">d</span> 目录
</code></pre><h3 id="netstat">netstat</h3><pre><code>显示TCP端口：netstat -tanp
显示UDP端口：netstat -uanp
</code></pre><h3 id="su">su</h3><pre><code>用户切换：<span class="keyword">su</span> 用户名
</code></pre><h3 id="ps">ps</h3><pre><code>查看进程：<span class="keyword">ps</span> -ef | <span class="keyword">grep</span> 进程名
</code></pre>]]></content>
    <summary type="html">
    <![CDATA[<p>日常使用的高频率linux命令汇总，例如：rm、tar、find、ps、unzip等。<br>]]>
    
    </summary>
    
      <category term="linux" scheme="http://www.okaywit.com/tags/linux/"/>
    
      <category term="日常笔记" scheme="http://www.okaywit.com/categories/%E6%97%A5%E5%B8%B8%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
</feed>